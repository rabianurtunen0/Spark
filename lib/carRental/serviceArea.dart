import 'dart:async';
import 'dart:math';
import 'package:bootstrap_icons/bootstrap_icons.dart';
import 'package:flutter/material.dart';
import 'package:flutter_screenutil/flutter_screenutil.dart';
import 'package:get/get_core/src/get_main.dart';
import 'package:get/get_navigation/get_navigation.dart';
import 'package:google_maps_flutter/google_maps_flutter.dart';

class ServiceAreaPage extends StatefulWidget {
  const ServiceAreaPage({super.key});

  @override
  State<ServiceAreaPage> createState() => _ServiceAreaPageState();
}

class _ServiceAreaPageState extends State<ServiceAreaPage> {
  Completer<GoogleMapController> _controller = Completer();
  LatLng currentLatLng = const LatLng(37.928611, 32.481103);
  List<Marker> markersList = [];
  List<LatLng> polygonPoints = [
    LatLng(38.032265, 32.510648),
    LatLng(38.028983, 32.514680),
    LatLng(38.020659, 32.514792),
    LatLng(38.020078, 32.516897),
    LatLng(38.020576, 32.518897),
    LatLng(38.018746, 32.523986),
    LatLng(38.017398, 32.529382),
    LatLng(38.016265, 32.534456),
    LatLng(38.014919, 32.536746),
    LatLng(38.006965, 32.536763),
    LatLng(38.006054, 32.537192),
    LatLng(38.004521, 32.537142),
    LatLng(38.003728, 32.536870),
    LatLng(38.003842, 32.536108),
    LatLng(38.002044, 32.536048),
    LatLng(37.998174, 32.534075),
    LatLng(37.984932, 32.530529),
    LatLng(37.981500, 32.524474),
    LatLng(37.980163, 32.526951),
    LatLng(37.978972, 32.527607),
    LatLng(37.978197, 32.527583),
    LatLng(37.976009, 32.529148),
    LatLng(37.974920, 32.529834),
    LatLng(37.972235, 32.530452),
    LatLng(37.967969, 32.530473),
    LatLng(37.967434, 32.531456),
    LatLng(37.967081, 32.531455),
    LatLng(37.965400, 32.530055),
    LatLng(37.963363, 32.531155),
    LatLng(37.963434, 32.533128),
    LatLng(37.958583, 32.533898),
    LatLng(37.958381, 32.532818),
    LatLng(37.958812, 32.531632),
    LatLng(37.959253, 32.529698),
    LatLng(37.958182, 32.528525),
    LatLng(37.955942, 32.530218),
    LatLng(37.956396, 32.532094),
    LatLng(37.956558, 32.533783),
    LatLng(37.955065, 32.536212),
    LatLng(37.952043, 32.535549),
    LatLng(37.950736, 32.537693),
    LatLng(37.932004, 32.528213),
    LatLng(37.927255, 32.530142),
    LatLng(37.913115, 32.518813),
    LatLng(37.911496, 32.523221),
    LatLng(37.901032, 32.535030),
    LatLng(37.879356, 32.545760),
    LatLng(37.878641, 32.552546),
    LatLng(37.869330, 32.553086),
    LatLng(37.869960, 32.547421),
    LatLng(37.856347, 32.545211),
    LatLng(37.847606, 32.543394),
    LatLng(37.844748, 32.542504),
    LatLng(37.843958, 32.541839),
    LatLng(37.842929, 32.540190),
    LatLng(37.834702, 32.521304),
    LatLng(37.833469, 32.519926),
    LatLng(37.830686, 32.518443),
    LatLng(37.829101, 32.515930),
    LatLng(37.828049, 32.510602),
    LatLng(37.828289, 32.504026),
    LatLng(37.828527, 32.498657),
    LatLng(37.828952, 32.492674),
    LatLng(37.830274, 32.488022),
    LatLng(37.830893, 32.485572),
    LatLng(37.830945, 32.484830),
    LatLng(37.830905, 32.483617),
    LatLng(37.829542, 32.479483),
    LatLng(37.825214, 32.467561),
    LatLng(37.815809, 32.448299),
    LatLng(37.810112, 32.431972),
    LatLng(37.808131, 32.425918),
    LatLng(37.808669, 32.401944),
    LatLng(37.818266, 32.400012),
    LatLng(37.823773, 32.407358),
    LatLng(37.827097, 32.411594),
    LatLng(37.832850, 32.415299),
    LatLng(37.838482, 32.416591),
    LatLng(37.839945, 32.417446),
    LatLng(37.840157, 32.417522),
    LatLng(37.840441, 32.417501),
    LatLng(37.840716, 32.417473),
    LatLng(37.841825, 32.417121),
    LatLng(37.841996, 32.417082),
    LatLng(37.842327, 32.417129),
    LatLng(37.844213, 32.417534),
    LatLng(37.844508, 32.417688),
    LatLng(37.844824, 32.417943),
    LatLng(37.845122, 32.418285),
    LatLng(37.845540, 32.418879),
    LatLng(37.845703, 32.419085),
    LatLng(37.845926, 32.419251),
    LatLng(37.846283, 32.419406),
    LatLng(37.846529, 32.419430),
    LatLng(37.846751, 32.419370),
    LatLng(37.847217, 32.419191),
    LatLng(37.847417, 32.419167),
    LatLng(37.848068, 32.419432),
    LatLng(37.848942, 32.420314),
    LatLng(37.849160, 32.420466),
    LatLng(37.849328, 32.420519),
    LatLng(37.849377, 32.420519),
    LatLng(37.849517, 32.420497),
    LatLng(37.849768, 32.420412),
    LatLng(37.850170, 32.420195),
    LatLng(37.850405, 32.420004),
    LatLng(37.850657, 32.419936),
    LatLng(37.852332, 32.419187),
    LatLng(37.853129, 32.418189),
    LatLng(37.852491, 32.416640),
    LatLng(37.853669, 32.414409),
    LatLng(37.856025, 32.414278),
    LatLng(37.856255, 32.415423),
    LatLng(37.856596, 32.415998),
    LatLng(37.856800, 32.417317),
    LatLng(37.856437, 32.418297),
    LatLng(37.856820, 32.419977),
    LatLng(37.857155, 32.420703),
    LatLng(37.857527, 32.421842),
    LatLng(37.857652, 32.422093),
    LatLng(37.858315, 32.422598),
    LatLng(37.860348, 32.423008),
    LatLng(37.860790, 32.423171),
    LatLng(37.861527, 32.423948),
    LatLng(37.862949, 32.425016),
    LatLng(37.866380, 32.422051),
    LatLng(37.867157, 32.420695),
    LatLng(37.867917, 32.420051),
    LatLng(37.870407, 32.419525),
    LatLng(37.871373, 32.421480),
    LatLng(37.871682, 32.424749),
    LatLng(37.872325, 32.426408),
    LatLng(37.875843, 32.428658),
    LatLng(37.877044, 32.424528),
    LatLng(37.882130, 32.429045),
    LatLng(37.884763, 32.427176),
    LatLng(37.887544, 32.427603),
    LatLng(37.888785, 32.429719),
    LatLng(37.893656, 32.436959),
    LatLng(37.896609, 32.437972),
    LatLng(37.902893, 32.444027),
    LatLng(37.908410, 32.447098),
    LatLng(37.916474, 32.442572),
    LatLng(37.916544, 32.441366),
    LatLng(37.918628, 32.440937),
    LatLng(37.920756, 32.437832),
    LatLng(37.924256, 32.436656),
    LatLng(37.926352, 32.436618),
    LatLng(37.925959, 32.437566),
    LatLng(37.924868, 32.438542),
    LatLng(37.925060, 32.440035),
    LatLng(37.924840, 32.442625),
    LatLng(37.924800, 32.443770),
    LatLng(37.924737, 32.445072),
    LatLng(37.924852, 32.446347),
    LatLng(37.925165, 32.447232),
    LatLng(37.925028, 32.448442),
    LatLng(37.924996, 32.449742),
    LatLng(37.924947, 32.450315),
    LatLng(37.924939, 32.451337),
    LatLng(37.924797, 32.453869),
    LatLng(37.924930, 32.455681),
    LatLng(37.925269, 32.455872),
    LatLng(37.925109, 32.456648),
    LatLng(37.925790, 32.456924),
    LatLng(37.926070, 32.457172),
    LatLng(37.926553, 32.457389),
    LatLng(37.926721, 32.457591),
    LatLng(37.927109, 32.458090),
    LatLng(37.927261, 32.458281),
    LatLng(37.927594, 32.458988),
    LatLng(37.928214, 32.459665),
    LatLng(37.929287, 32.460153),
    LatLng(37.929541, 32.460197),
    LatLng(37.931676, 32.458164),
    LatLng(37.934295, 32.459026),
    LatLng(37.940836, 32.461157),
    LatLng(37.944752, 32.462879),
    LatLng(37.950170, 32.458907),
    LatLng(37.950446, 32.455282),
    LatLng(37.950481, 32.453850),
    LatLng(37.951023, 32.452007),
    LatLng(37.950781, 32.449741),
    LatLng(37.951851, 32.449243),
    LatLng(37.952460, 32.450448),
    LatLng(37.953805, 32.450373),
    LatLng(37.954494, 32.448988),
    LatLng(37.955181, 32.448533),
    LatLng(37.955668, 32.448871),
    LatLng(37.956555, 32.449795),
    LatLng(37.957749, 32.450810),
    LatLng(37.958553, 32.452417),
    LatLng(37.958486, 32.453269),
    LatLng(37.959952, 32.454484),
    LatLng(37.959970, 32.455394),
    LatLng(37.959317, 32.456716),
    LatLng(37.958147, 32.457830),
    LatLng(37.957928, 32.459275),
    LatLng(37.958065, 32.460823),
    LatLng(37.958591, 32.462392),
    LatLng(37.958842, 32.463184),
    LatLng(37.958936, 32.465071),
    LatLng(37.960291, 32.464065),
    LatLng(37.961083, 32.464372),
    LatLng(37.965227, 32.468994),
    LatLng(37.967013, 32.473224),
    LatLng(37.968879, 32.475893),
    LatLng(37.971484, 32.477995),
    LatLng(37.970373, 32.485413),
    LatLng(37.978765, 32.492187),
    LatLng(37.986388, 32.486052),
    LatLng(37.990572, 32.490517),
    LatLng(37.990707, 32.494100),
    LatLng(37.989380, 32.494414),
    LatLng(37.988108, 32.492273),
    LatLng(37.985746, 32.497069),
    LatLng(37.985363, 32.497564),
    LatLng(37.981979, 32.498257),
    LatLng(37.981761, 32.506134),
    LatLng(37.984391, 32.506261),
    LatLng(37.989493, 32.506046),
    LatLng(37.992759, 32.507083),
    LatLng(37.996951, 32.510365),
    LatLng(37.998619, 32.510265),
    LatLng(37.999770, 32.513778),
    LatLng(38.018654, 32.508554),
    LatLng(38.021080, 32.502885),
    LatLng(38.024977, 32.502200),
    LatLng(38.028028, 32.502122),
  ];

  @override
  void initState() {
    super.initState();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      extendBody: true,
      extendBodyBehindAppBar: true,
      appBar: AppBar(
        elevation: 0.0,
        backgroundColor: Theme.of(context).primaryColor,
        leading: Container(
          alignment: Alignment.centerLeft,
          margin:
              EdgeInsets.only(left: MediaQuery.of(context).size.width * 0.035),
          child: IconButton(
            onPressed: () {
              setState(() {
                Get.back();
              });
            },
            icon: Icon(
              Icons.arrow_back,
              size: ScreenUtil().setSp(17),
              color: Colors.white,
            ),
            splashColor: Colors.transparent,
            highlightColor: Colors.transparent,
          ),
        ),
        title: Text('Service Area',
            style: TextStyle(
                color: Colors.white,
                fontWeight: FontWeight.w600,
                fontSize: ScreenUtil().setSp(14),
                letterSpacing: 1.0)),
      ),
      body: GoogleMap(
        myLocationEnabled: true,
        myLocationButtonEnabled: false,
        zoomControlsEnabled: false,
        mapType: MapType.normal,
        initialCameraPosition:
            CameraPosition(target: currentLatLng, zoom: 11.5),
        onMapCreated: (controller) {
          setState(() {
            _controller = Completer<GoogleMapController>();
            _controller.complete(controller);
          });
        },
        polygons: {
          Polygon(
            polygonId: PolygonId('Konya Area'),
            points: polygonPoints,
            strokeWidth: 2,
            strokeColor: Theme.of(context).primaryColor,
            fillColor: Theme.of(context).primaryColor.withOpacity(0.3),
          ),
        },
      ),
    );
  }
}
